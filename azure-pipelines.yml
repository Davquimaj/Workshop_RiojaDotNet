variables:
  solution: '**/cpplinq_examples.sln'
  buildPlatform: 'x64'
  buildConfiguration: 'Release'

jobs:
- job: 'cpp'

  strategy:
    matrix:
      High Sierra:
        imageName: 'macos-10.13'
      Mojave:
        imageName: 'macos-10.14'
      Ubuntu:
        imageName: 'ubuntu-16.04'
      Visual Studio 2015:
        imageName: 'vs2015-win2012r2'
        generator: '-G "Visual Studio 14 2015 -A x64'
      Visual Studio 2017:
        imageName: 'vs2017-win2016'
        generator: '-G "Visual Studio 15 2017 -A x64'
      Visual Studio 2019:
        imageName: 'windows-2019'
        generator: '-G "Visual Studio 16 2019" -A x64'
  pool:
    vmImage: $(imageName)

  displayName: 'NetCore C++'
  
  steps:
  - checkout: self
    submodules: true
 
  - task: CMake@1
    displayName: 'CMake .. -G"$(generator)"'
    inputs:
      workingDirectory: 'build'
      cmakeArgs: '"src\C++ Library" $(generator)"' 
   
  - script: |
      cd "src\C++ Library\build"
      cmake --build . --target --config $(buildConfiguration)
    displayName: 'Compile'